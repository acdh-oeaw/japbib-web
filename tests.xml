<?xml version="1.0" encoding="UTF-8"?>
<tests>
    <test n="1" title="simple string with quotes">
        <input>"cat"</input>
        <expected>
            <searchClause>
                <index>cql.serverChoice</index>
                <relation>
                    <value>scr</value>
                </relation>
                <term>cat</term>
            </searchClause>
        </expected>
    </test>
    <test n="2" title="empty string">
        <input>""</input>
        <expected>
            <searchClause>
                <index>cql.serverChoice</index>
                <relation>
                    <value>scr</value>
                </relation>
                <term/>
            </searchClause>
        </expected>
    </test>
    <test n="3" title="one OR triple">
        <input>"cat" or dog</input>
        <expected>
            <triple>
                <boolean>
                    <value>or</value>
                </boolean>
                <leftOperand>
                    <searchClause>
                        <index>cql.serverChoice</index>
                        <relation>
                            <value>scr</value>
                        </relation>
                        <term>cat</term>
                    </searchClause>
                </leftOperand>
                <rightOperand>
                    <searchClause>
                        <index>cql.serverChoice</index>
                        <relation>
                            <value>scr</value>
                        </relation>
                        <term>dog</term>
                    </searchClause>
                </rightOperand>
            </triple>
        </expected>
    </test>
    <test n="4" title="simple AND + OR triples">
        <input>cat and dog or house</input>
        <expected>
            <triple>
                <boolean>
                    <value>or</value>
                </boolean>
                <leftOperand>
                    <triple>
                        <boolean>
                            <value>and</value>
                        </boolean>
                        <leftOperand>
                            <searchClause>
                                <index>cql.serverChoice</index>
                                <relation>
                                    <value>scr</value>
                                </relation>
                                <term>cat</term>
                            </searchClause>
                        </leftOperand>
                        <rightOperand>
                            <searchClause>
                                <index>cql.serverChoice</index>
                                <relation>
                                    <value>scr</value>
                                </relation>
                                <term>dog</term>
                            </searchClause>
                        </rightOperand>
                    </triple>
                </leftOperand>
                <rightOperand>
                    <searchClause>
                        <index>cql.serverChoice</index>
                        <relation>
                            <value>scr</value>
                        </relation>
                        <term>house</term>
                    </searchClause>
                </rightOperand>
            </triple>
        </expected>
    </test>
    <test n="5" title="simple index equals value search">
        <input>title=cat</input>
        <expected>
            <searchClause>
                <index>title</index>
                <relation>
                    <value>=</value>
                </relation>
                <term>cat</term>
            </searchClause>
        </expected>
    </test>
    <test n="6" title="qualified index contains value search">
        <input>dc.title contains cat</input>
        <expected>
            <searchClause>
                <index>dc.title</index>
                <relation>
                    <value>contains</value>
                </relation>
                <term>cat</term>
            </searchClause>
        </expected>
    </test>
    <test n="7" title="3 index searchClauses">
        <input>dc.title contains "sea" AND dc.author = Hemingway AND year > 1920</input>
        <expected>
            <triple>
                <boolean>
                    <value>and</value>
                </boolean>
                <leftOperand>
                    <triple>
                        <boolean>
                            <value>and</value>
                        </boolean>
                        <leftOperand>
                            <searchClause>
                                <index>dc.title</index>
                                <relation>
                                    <value>contains</value>
                                </relation>
                                <term>sea</term>
                            </searchClause>
                        </leftOperand>
                        <rightOperand>
                            <searchClause>
                                <index>dc.author</index>
                                <relation>
                                    <value>=</value>
                                </relation>
                                <term>Hemingway</term>
                            </searchClause>
                        </rightOperand>
                    </triple>
                </leftOperand>
                <rightOperand>
                    <searchClause>
                        <index>year</index>
                        <relation>
                            <value>></value>
                        </relation>
                        <term>1920</term>
                    </searchClause>
                </rightOperand>
            </triple>
        </expected>
    </test>
    <test n="8" title="3 index searchClauses with grouping">
        <input>dc.title contains "sea" OR (dc.author = Hemingway AND year > 1920)</input>
        <expected>
            <triple>
                <boolean>
                    <value>or</value>
                </boolean>
                <leftOperand>
                    <searchClause>
                        <index>dc.title</index>
                        <relation>
                            <value>contains</value>
                        </relation>
                        <term>sea</term>
                    </searchClause>
                </leftOperand>
                <rightOperand>
                    <triple>
                        <boolean>
                            <value>and</value>
                        </boolean>
                        <leftOperand>
                            <searchClause>
                                <index>dc.author</index>
                                <relation>
                                    <value>=</value>
                                </relation>
                                <term>Hemingway</term>
                            </searchClause>
                        </leftOperand>
                        <rightOperand>
                            <searchClause>
                                <index>year</index>
                                <relation>
                                    <value>></value>
                                </relation>
                                <term>1920</term>
                            </searchClause>
                        </rightOperand>
                    </triple>
                </rightOperand>
            </triple>
        </expected>
    </test>
</tests>
